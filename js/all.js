"use strict";String.prototype.capitalise=function(){return this.charAt(0).toUpperCase()+this.slice(1)};function arraySortByKey(e,t){return!!Array.isArray(e)&&e.sort(function(e,n){var i=e[t],a=n[t];return i<a?-1:i>a?1:0})}var checkType=(e,t)=>{let n=!1;switch(t){case"array":n=!!Array.isArray(e);break;case"boolean":case"bool":n=!("boolean"!=typeof e);break;case"float":n=!(Number.isInteger(e)||"number"!=typeof e);break;case"integer":case"int":n=!!Number.isInteger(e);break;case"number":n=!("number"!=typeof e);break;case"object":n=!("object"!=typeof e);break;case"string":case"str":n=!("string"!=typeof e);break;default:console.error(`This type (${t}) has no check!\nUnable to test variables validity.`),n=!1;}return n};function convertToRoman(e){let t={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1},n="";for(let a of Object.keys(t)){let i=~~(e/t[a]);e-=i*t[a],n+=a.repeat(i)}return n}var crc32=function(e){for(var i,d=[],o=0;256>o;o++){i=o;for(var s=0;8>s;s++)i=1&i?3988292384^i>>>1:i>>>1;d[o]=i}for(var r=-1,l=0;l<e.length;l++)r=r>>>8^d[255&(r^e.charCodeAt(l))];return(-1^r)>>>0};function framesToMs(e){return!!Number.isInteger(e)&&1e3/60*e}function generateRandomID(e=!1){let t="",n=e?16:8;for(let a=0;a<n;a++)t+=~~(9*Math.random()+1).toString();return t}function generateUserID(){let e=Phaser.Utils.Array.NumberArray(0,9),t=32;for(let n=33;n<33+t-6;n++)e.push(String.fromCharCode(n+t));let n=[];[540541546547,176178179].forEach(e=>{for(let t,i=e.toString();i;)t=i.slice(-3),i=i.replace(t,""),n.push(~~t)}),n.reverse(),n.forEach(t=>{for(let n=2;n;)e.push(String.fromCharCode(t)),n--});let i="",a=[1,2,3,4,5];return a.forEach(t=>{for(let n,a=Math.pow(2,t-1);a;)n=getRandom(e),i+=n,a--;t<a.length?i+="_":null}),i}function getRandom(e,t=null){if(!Phaser)return console.error(`This function needs Phaser to be initialised before use!`),!1;if(Array.isArray(e))return Phaser.Math.RND.pick(e);return"number"==typeof e&&"number"==typeof t?Phaser.Math.RND.between(e,t):"string"==typeof e&&null===t?Phaser.Math.RND.pick(e.split("")):void console.error("The first passed var must either be an array, integer or string. If a 2nd value is passed it must be an integer")}function getStringExtForInt(e){if(!Number.isInteger(e))return!1;let t=e.toString(),n="th";return"1"===t.substr(-1)&&11!==e?n="st":"2"===t.substr(-1)&&12!==e?n="nd":"3"===t.substr(-1)&&13!==e&&(n="rd"),n}function isVar(e="Phaser"){let t="";for(var n in"Phaser"===e&&(t="No variable passed... Searching for Phaser variable\n"),window)if(window.hasOwnProperty(n)&&n===e)return t+=`Found the variable '${e}'`,vars.DEBUG&&console.log(t),!0;return!1}function shuffle(e){for(var t,n,i=e.length;0!==i;)n=Math.floor(Math.random()*i),i-=1,t=e[i],e[i]=e[n],e[n]=t;return e}var LZString=function(){function a(t,i){if(!e[t]){e[t]={};for(var a=0;a<t.length;a++)e[t][t.charAt(a)]=a}return e[t][i]}var l=String.fromCharCode,e={},d={compressToBase64:function(e){if(null==e)return"";var t=d._compress(e,6,function(e){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e)});switch(t.length%4){default:case 0:return t;case 1:return t+"===";case 2:return t+"==";case 3:return t+"=";}},decompressFromBase64:function(t){return null==t?"":""==t?null:d._decompress(t.length,32,function(n){return a("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t.charAt(n))})},compressToUTF16:function(e){return null==e?"":d._compress(e,15,function(e){return l(e+32)})+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:d._decompress(e.length,16384,function(t){return e.charCodeAt(t)-32})},compressToUint8Array:function(i){for(var a,o=d.compress(i),r=new Uint8Array(2*o.length),n=0,l=o.length;l>n;n++)a=o.charCodeAt(n),r[2*n]=a>>>8,r[2*n+1]=a%256;return r},decompressFromUint8Array:function(i){if(null===i||void 0===i)return d.decompress(i);for(var a=Array(i.length/2),n=0,o=a.length;o>n;n++)a[n]=256*i[2*n]+i[2*n+1];var t=[];return a.forEach(function(e){t.push(l(e))}),d.decompress(t.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":d._compress(e,6,function(e){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$".charAt(e)})},decompressFromEncodedURIComponent:function(e){return null==e?"":""==e?null:(e=e.replace(/ /g,"+"),d._decompress(e.length,32,function(t){return a("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",e.charAt(t))}))},compress:function(e){return d._compress(e,16,function(e){return l(e)})},_compress:function(g,o,r){if(null==g)return"";var n,w,b,S={},s={},p="",y="",O="",D=2,x=3,T=2,I=[],d=0,C=0;for(b=0;b<g.length;b+=1)if(p=g.charAt(b),Object.prototype.hasOwnProperty.call(S,p)||(S[p]=x++,s[p]=!0),y=O+p,Object.prototype.hasOwnProperty.call(S,y))O=y;else{if(Object.prototype.hasOwnProperty.call(s,O)){if(256>O.charCodeAt(0)){for(n=0;T>n;n++)d<<=1,C==o-1?(C=0,I.push(r(d)),d=0):C++;for(w=O.charCodeAt(0),n=0;8>n;n++)d=d<<1|1&w,C==o-1?(C=0,I.push(r(d)),d=0):C++,w>>=1}else{for(w=1,n=0;T>n;n++)d=d<<1|w,C==o-1?(C=0,I.push(r(d)),d=0):C++,w=0;for(w=O.charCodeAt(0),n=0;16>n;n++)d=d<<1|1&w,C==o-1?(C=0,I.push(r(d)),d=0):C++,w>>=1}D--,0==D&&(D=Math.pow(2,T),T++),delete s[O]}else for(w=S[O],n=0;T>n;n++)d=d<<1|1&w,C==o-1?(C=0,I.push(r(d)),d=0):C++,w>>=1;D--,0==D&&(D=Math.pow(2,T),T++),S[y]=x++,O=p+""}if(""!==O){if(Object.prototype.hasOwnProperty.call(s,O)){if(256>O.charCodeAt(0)){for(n=0;T>n;n++)d<<=1,C==o-1?(C=0,I.push(r(d)),d=0):C++;for(w=O.charCodeAt(0),n=0;8>n;n++)d=d<<1|1&w,C==o-1?(C=0,I.push(r(d)),d=0):C++,w>>=1}else{for(w=1,n=0;T>n;n++)d=d<<1|w,C==o-1?(C=0,I.push(r(d)),d=0):C++,w=0;for(w=O.charCodeAt(0),n=0;16>n;n++)d=d<<1|1&w,C==o-1?(C=0,I.push(r(d)),d=0):C++,w>>=1}D--,0==D&&(D=Math.pow(2,T),T++),delete s[O]}else for(w=S[O],n=0;T>n;n++)d=d<<1|1&w,C==o-1?(C=0,I.push(r(d)),d=0):C++,w>>=1;D--,0==D&&(D=Math.pow(2,T),T++)}for(w=2,n=0;T>n;n++)d=d<<1|1&w,C==o-1?(C=0,I.push(r(d)),d=0):C++,w>>=1;for(;;){if(d<<=1,C==o-1){I.push(r(d));break}C++}return I.join("")},decompress:function(e){return null==e?"":""==e?null:d._decompress(e.length,32768,function(t){return e.charCodeAt(t)})},_decompress:function(r,o,n){var e,g,b,S,y,O,D,x,T=[],f=4,I=4,C=3,U="",E=[],w={val:n(0),position:o,index:1};for(g=0;3>g;g+=1)T[g]=g;for(S=0,O=Math.pow(2,2),D=1;D!=O;)y=w.val&w.position,w.position>>=1,0==w.position&&(w.position=o,w.val=n(w.index++)),S|=(0<y?1:0)*D,D<<=1;switch(e=S){case 0:for(S=0,O=Math.pow(2,8),D=1;D!=O;)y=w.val&w.position,w.position>>=1,0==w.position&&(w.position=o,w.val=n(w.index++)),S|=(0<y?1:0)*D,D<<=1;x=l(S);break;case 1:for(S=0,O=Math.pow(2,16),D=1;D!=O;)y=w.val&w.position,w.position>>=1,0==w.position&&(w.position=o,w.val=n(w.index++)),S|=(0<y?1:0)*D,D<<=1;x=l(S);break;case 2:return"";}for(T[3]=x,b=x,E.push(x);;){if(w.index>r)return"";for(S=0,O=Math.pow(2,C),D=1;D!=O;)y=w.val&w.position,w.position>>=1,0==w.position&&(w.position=o,w.val=n(w.index++)),S|=(0<y?1:0)*D,D<<=1;switch(x=S){case 0:for(S=0,O=Math.pow(2,8),D=1;D!=O;)y=w.val&w.position,w.position>>=1,0==w.position&&(w.position=o,w.val=n(w.index++)),S|=(0<y?1:0)*D,D<<=1;T[I++]=l(S),x=I-1,f--;break;case 1:for(S=0,O=Math.pow(2,16),D=1;D!=O;)y=w.val&w.position,w.position>>=1,0==w.position&&(w.position=o,w.val=n(w.index++)),S|=(0<y?1:0)*D,D<<=1;T[I++]=l(S),x=I-1,f--;break;case 2:return E.join("");}if(0==f&&(f=Math.pow(2,C),C++),T[x])U=T[x];else{if(x!==I)return null;U=b+b.charAt(0)}E.push(U),T[I++]=b+U.charAt(0),f--,b=U,0==f&&(f=Math.pow(2,C),C++)}}};return d}();"function"==typeof define&&define.amd?define(function(){return LZString}):"undefined"!=typeof module&&null!=module&&(module.exports=LZString),"use strict";var vars={DEBUG:!1,version:.981,todo:[["Finish implementing fly over then fleet"],["When going to the options screen after the game was lost/won it doesnt get rid of the loss/win game screen"],["After clicking new game/ start game it should show a new screen saying that its generating the board"]],boardSize:{width:10,widthMin:6,widthMax:78,height:10,heightMin:6,heightMax:42},boardSizes:{small:{width:10,height:10},medium:{width:16,height:16},big:{width:24,height:24},vbig:{width:40,height:30},insur:{width:60,height:40}},boardSetSize:(e,t)=>{vars.DEBUG&&console.log(`Setting the board size to ${e},${t}`),vars.boardSize.width=e,vars.boardSize.height=t},boardSizeWidthIncrease:(e=!0)=>{let t=vars.boardSize,n=vars.localStorage,i=n.userDefinedWidth;e?i<t.widthMax?n.userDefinedWidth+=2:null:i>t.widthMin?n.userDefinedWidth-=2:null;t.width=n.userDefinedWidth,vars.localStorage.updateUserDefinedWidth(),vars.UI.updateOptionsBoardSizeWidth()},boardSizeHeightIncrease:(e=!0)=>{let t=vars.boardSize,n=vars.localStorage,i=n.userDefinedHeight;e?i<t.heightMax?n.userDefinedHeight+=2:null:i>t.heightMin?n.userDefinedHeight-=2:null;t.height=n.userDefinedHeight,vars.localStorage.updateUserDefinedHeight(),vars.UI.updateOptionsBoardSizeHeight()},boardTileSizes:null,difficulty:{current:"easy",minePercent:{easy:.1,medium:.2,hard:.3,veryhard:.4},getMinePercentage:()=>{let e=vars.difficulty;return e.minePercent[e.current]}},fonts:{default:{fontFamily:"Consolas",fontSize:"32px",color:"#00ff00",stroke:"#AA",strokeThickness:3,shadow:{offsetX:3,offsetY:3,blur:5}},number:{fontFamily:"Consolas",fontSize:"60px",color:"#ffffff",stroke:"#000000",strokeThickness:2,shadow:{offsetX:1,offsetY:1,blur:2}}},reveal:{count:0,revealing:[],instant:!0,all:()=>{vars.containers.unclicked.list.forEach(e=>{e.alpha=0})},reset:()=>{vars.revealCount=0,vars.revealing=[]}},tileSizes:[32,48,64],tileType:"water",maxWHs:[[78,42],[52,28],[39,20]],phaserObjects:{},make2DArray:(e,t)=>{let n=Array(e);for(let a=0;a<n.length;a++)n[a]=Array(t);return n},init:function(e){switch(e){case"PRELOAD":vars.UI.iniLoadingScreen(),vars.files.loadAssets(),vars.localStorage.init();break;case"CREATE":vars.audio.init(),vars.anims.init(),vars.camera.init(),vars.containers.init(!0),vars.groups.init(),vars.input.init(),vars.particles.init(),vars.UI.init();break;case"STARTAPP":scene.tweens.add({targets:vars.containers.loadingScreen,alpha:0,delay:1e3,duration:1e3,onComplete:()=>{vars.containers.loadingScreen.destroy()}});break;default:return console.error(`Phase (${e}) was invalid!`),!1;}},files:{audio:{load:function(){scene.load.audio("explosionWater","sounds/explosionWater.ogg"),scene.load.audio("aircraftDrone","sounds/aircraftDrone.ogg")}},fonts:{load:()=>{scene.load.bitmapFont("defaultFont","font/rdFont.png","font/rdFont.xml"),scene.load.bitmapFont("defaultFontSmall","font/rdFontSmall.png","font/rdFontSmall.xml")}},images:{load:function(){scene.load.atlas("mapPieces","images/mapPieces.png","images/mapPieces.json"),scene.load.atlas("options","images/options.png","images/options.json"),scene.load.atlas("ui","images/ui.png","images/ui.json"),scene.load.image("whitepixel","images/whitepixel.png")}},loadAssets:function(){scene.load.setPath("assets");let e=vars.files;e.audio.load(),e.images.load(),e.fonts.load()}},containers:{init:function(e=!1){vars.DEBUG&&console.log(`%cFN: containers > init`,`${consts.console.defaults} ${consts.console.colours.functionCall}`);let t=consts.depths;scene.containers?null:scene.containers={},vars.containers.clicked=scene.containers.clicked=scene.add.container().setName("clicked").setDepth(t.clicked),vars.containers.unclicked=scene.containers.unclicked=scene.add.container().setName("unclicked").setDepth(t.unclicked),vars.containers.flags=scene.containers.flags=scene.add.container().setName("flags").setDepth(t.flags),e?vars.containers.gameUI=scene.containers.gameUI=scene.add.container().setName("gameUI").setDepth(t.gameUI):null,e?vars.containers.options=scene.containers.options=scene.add.container().setName("options").setDepth(t.options):null,e?vars.containers.generatingMap=scene.containers.generatingMap=scene.add.container().setName("generatingMap").setDepth(t.generatingMap):null,e&&vars.DEBUG?vars.containers.debug=scene.containers.debug=scene.add.container().setName("debug").setDepth(t.debug):null},showGenMap:(e=!0)=>{scene.containers.generatingMap.setVisible(e)}},groups:{init:function(){scene.groups={}},createGroupsForColumns:()=>{vars.DEBUG&&console.log(`Generating groups for map`);let e=vars.boardSize,t=e.width;for(let e=0;e<t;e++)vars.groups[`colGroup_${e}`]=scene.add.group().setName(`colGroup_${e}`)}},localStorage:{userDefinedWidth:null,userDefinedHeight:null,uData:{l:0,w:0,i:0},pre:"mS",init:function(){let e=window.localStorage,t=vars.localStorage;e[`${t.pre}_userDefinedWidth`]?null:e[`${t.pre}_userDefinedWidth`]=10,t.userDefinedWidth=0|e[`${t.pre}_userDefinedWidth`],e[`${t.pre}_userDefinedHeight`]?null:e[`${t.pre}_userDefinedHeight`]=10,t.userDefinedHeight=0|e[`${t.pre}_userDefinedHeight`],e[`${t.pre}_losses`]?null:e[`${t.pre}_losses`]=0,t.uData.l=0|e[`${t.pre}_losses`],e[`${t.pre}_wins`]?null:e[`${t.pre}_wins`]=0,t.uData.w=0|e[`${t.pre}_wins`],e[`${t.pre}_instaDeaths`]?null:e[`${t.pre}_instaDeaths`]=0,t.uData.i=0|e[`${t.pre}_instaDeaths`]},incrementInstaDeaths:()=>{let e=window.localStorage,t=vars.localStorage;t.uData.i++,e[`${t.pre}_instaDeaths`]=t.uData.i},incrementLosses:()=>{let e=window.localStorage,t=vars.localStorage;t.uData.l++,e[`${t.pre}_losses`]=t.uData.l,3>vars.game.move?t.incrementInstaDeaths():null,vars.UI.updateStats()},incrementWins:()=>{let e=window.localStorage,t=vars.localStorage;t.uData.w++,e[`${t.pre}_wins`]=t.uData.w,vars.UI.updateStats()},resetAll:()=>{vars.DEBUG&&console.log(`Reseting user data...`);let e=vars.localStorage;e.uData={l:0,w:0,i:0};let t=window.localStorage;t[`${e.pre}_userDefinedWidth`]=10,t[`${e.pre}_userDefinedHeight`]=10,t[`${e.pre}_losses`]=0,t[`${e.pre}_wins`]=0,t[`${e.pre}_instaDeaths`]=0},updateUserDefinedHeight:()=>{let e=window.localStorage,t=vars.localStorage;e[`${t.pre}_userDefinedHeight`]=vars.boardSize.height,vars.DEBUG&&console.log(`Saved user defined height`)},updateUserDefinedWidth:()=>{let e=window.localStorage,t=vars.localStorage;e[`${t.pre}_userDefinedWidth`]=vars.boardSize.width,vars.DEBUG&&console.log(`Saved user defined width`)}},anims:{init:()=>{let e=vars.anims;e.initExplosion()},initExplosion:()=>{scene.anims.create({key:"explosion",frames:scene.anims.generateFrameNames("mapPieces",{prefix:"explosion_",end:23})})},revealTiles:()=>{let e=vars.reveal;if(!e.count)return;let t=vars.reveal.instant,n=0,i=e.revealing.length;for(;e.revealing.length;){let a=e.revealing.shift();t?null:n++,a.idx=n,scene.tweens.add({targets:a,useFrames:!0,delay:n,duration:4,alpha:0,onComplete:(e,t)=>{t[0].idx===i-1&&vars.input.enable()}})}},rippleTiles:e=>{if(!checkType(e,"int"))return!1;let t=vars.boardSize.width,n=e-1,i=1;for(;0<=n;){let e=vars.groups[`colGroup_${n}`].children.entries;scene.tweens.add({targets:e,scale:3,useFrames:!0,delay:i,duration:10,yoyo:!0}),n--,i++}let a=e+1,o=1;for(;a<t;){let e=vars.groups[`colGroup_${a}`].children.entries;scene.tweens.add({targets:e,scale:3,useFrames:!0,delay:o,duration:10,yoyo:!0}),a++,o++}}},audio:{init:()=>{vars.DEBUG&&console.log(`%cFN: audio > init`,`${consts.console.defaults} ${consts.console.colours.functionCall}`),scene.sound.volume=.2},playAircraftDrone:()=>{vars.audio.playSound("aircraftDrone")},playExplosion:()=>{vars.audio.playSound("explosionWater")},playSound:e=>{vars.DEBUG&&console.log(`%c .. FN: audio > playSound`,`${consts.console.defaults} ${consts.console.colours.functionCall}`),scene.sound.play(e)}},camera:{currentZoom:10,minZoom:7,maxZoom:20,zoomInc:1,mainCam:null,init:function(){vars.DEBUG&&console.log(`%cFN: camera > init`,`${consts.console.defaults} ${consts.console.colours.functionCall}`),vars.camera.mainCam=scene.cameras.main},shake:function(e=1e3,t=null){if(vars.DEBUG?console.log(`%cFN: camera > shake`,`${consts.console.defaults} ${consts.console.colours.functionCall}`):null,!checkType(e,"int"))return!1;if(!t){let e=vars.game.visibleCount.total;t=100>=e?.002:400>=e?.005:600>=e?.01:.03}vars.camera.mainCam.shake(e,t)},zoomIn:(e=!0)=>{let t=vars.camera;e&&t.currentZoom<t.maxZoom?t.currentZoom+=t.zoomInc:!e&&t.currentZoom>t.minZoom&&(t.currentZoom-=t.zoomInc);t.mainCam.setZoom(t.currentZoom/10)},zoomReset:()=>{vars.camera.mainCam.zoomTo(1)}},game:{boatCount:0,grid:null,totalMines:0,flags:[],mines:[],mineNames:[],move:0,ready:!1,getMineByPosition:(e,t)=>!!(checkType(e,"int")&&checkType(t,"int"))&&vars.game.mines.find(n=>n.name.endsWith(`_${e}_${t}`)),visibleCount:{unlocked:0,total:0,reset:()=>{vars.game.visibleCount.unlocked=0},update:()=>{vars.game.visibleCount.unlocked++,vars.UI.updateVisibleCount()}},init:()=>{vars.DEBUG&&console.log(`\n%cFN: game > init`,`${consts.console.defaults.replace("14","16")} ${consts.console.colours.important}`);let e=vars.game;e.grid?e.grid=null:null,e.setWidthHeightOfBoard(),vars.groups.createGroupsForColumns(),vars.make2DArray(),e.generateNewGrid();let t=vars.UI;t.generateNewBoard(),t.updateVisibleCount(!0),vars.containers.showGenMap(!1),vars.containers.options.alpha&&e.ready?t.hideOptions():null},convertRedFlagsToGreenFlags:()=>{let e=vars.game,t=e.flags,n=vars.containers.flags;t.forEach(t=>{let i=t.name.split("_"),a={col:~~i[1],row:~~i[2]},o=e.getMineByPosition(a.col,a.row),d=t.width,s=t.x+d/2,r=t.y+d/2;if(o){let e=scene.add.image(s,r,"mapPieces",`greenflag${d}`).setScale(.9);n.add(e)}else{let e=scene.add.image(s,r,"mapPieces",`redflag${d}`).setScale(.9);n.add(e)}})},generateNewGrid:()=>{vars.DEBUG&&console.log(`Generating New Grid`);let e=vars.boardSize.width,t=vars.boardSize.height;vars.game.visibleCount.total=e*t;let n=vars.boardTileSizes.x,i=vars.game.totalMines=~~(vars.difficulty.getMinePercentage()*(e*t)),a=[];vars.game.grid=vars.make2DArray(e,t);for(let i=0;i<e;i++)for(let e=0;e<t;e++)vars.game.grid[i][e]=new Cell(i,e,n),a.push([i,e]);for(let e=0;e<i;e++){let e=getRandom(0,a.length-1),t=a.splice(e,1)[0],n=t[0],i=t[1];vars.game.grid[n][i].mine=!0}for(let n=0;n<e;n++)for(let e=0;e<t;e++)vars.game.grid[n][e].countMines();vars.UI.generateRevealedTiles()},new:()=>{vars.DEBUG&&console.log(`+++ Starting a new game! +++`),vars.containers.showGenMap(!0),scene.tweens.addCounter({from:0,to:1,useFrames:!0,duration:5,onComplete:()=>{let e=vars.game;e.move=0,e.mines=[],e.flags=[],e.visibleCount.reset();let t=vars.UI;t.updateVisibleCount(!0),t.gameOverFadeIn(!1),t.gameWinFadeIn(!1);let n=vars.containers;["clicked","unclicked","flags"].forEach(e=>{n[e].destroy()}),n.init(),e.init()}})},over:(e,t)=>{vars.DEBUG&&console.log(`💀💀💀 %cPlayer hit a mine, showing all the things%c 💀💀💀`,"font-size: 14px; color: red;","font-size: default"),vars.camera.zoomReset(),vars.reveal.all(),vars.localStorage.incrementLosses(),vars.camera.shake(1e3),vars.audio.playExplosion(),vars.game.convertRedFlagsToGreenFlags();let n=vars.UI.blowUpAllMinesByColumn(e,t);vars.anims.rippleTiles(e),scene.tweens.addCounter({from:0,to:1,useFrames:!0,duration:n+30,onComplete:()=>{vars.UI.gameOverFadeIn()}})},placeFlag:(e,t,n)=>{vars.DEBUG&&console.log(`Placing flag at col,row: ${e},${t}`);let i=vars.containers.unclicked,a=vars.game.flags,o=scene.add.image(e*n,t*n,"mapPieces",`redflag${n}`).setName(`redFlag_${e}_${t}`).setOrigin(0).setScale(.9).setInteractive();a.push(o),i.add(o),vars.UI.updateVisibleCount()},setWidthHeightOfBoard:()=>{let e=vars.boardSize,t=vars.tileSizes,n=vars.maxWHs,i={x:0,y:0,xIndex:null,yIndex:null};i.xIndex=e.width<=n[2][0]?2:e.width<=n[1][0]?1:0,i.yIndex=e.height<=n[2][1]?2:e.height<=n[1][1]?1:0;let a=i.xIndex>i.yIndex?t[i.yIndex]:t[i.xIndex];vars.boardTileSizes={...i,...{x:a,y:a}}},sortMinesIntoColumns:()=>{if(!vars.game.mines.length)return!1;let e={};return vars.game.mines.forEach(t=>{let n=~~t.name.split("_")[1];e[n]?null:e[n]=[],e[n].push(t)}),e},win:()=>{vars.DEBUG&&console.log(`Player has won!`),vars.camera.zoomReset(),vars.localStorage.incrementWins(),vars.game.visibleCount.reset(),vars.reveal.all();let e=vars.UI;e.generateFlyOver(),e.generateFleet()}},input:{enabled:!1,isEnabled:()=>vars.input.enabled,enable:(e=!0)=>{vars.DEBUG&&console.log(`%c${e?"Enabling":"Disabling"} input`,`color: ${e?"#4dff4d":"#ff4d4d"}`),vars.input.enabled=e},init:()=>{vars.DEBUG&&console.log(`%cFN: input > init`,`${consts.console.defaults} ${consts.console.colours.functionCall}`),vars.input.initCombos(),scene.input.on("gameobjectdown",function(e,t){if(1!==t.alpha)return!1;let n=t.name;if(n.startsWith("boardPosition")){if(1!==t.alpha)return!1;vars.game.move++;let i=n.split("_"),a=~~i[1],o=~~i[2],d=t.width;return 2===e.button?void vars.game.placeFlag(a,o,d):(vars.reveal.instant?null:vars.input.enable(!1),t.alpha=.99,void scene.tweens.add({targets:t,useFrames:!0,duration:5,alpha:0,onComplete:()=>(vars.DEBUG&&console.log(`Testing boardPosition`),"dead"===vars.game.grid[a][o].reveal())?void vars.game.over(a,o):void vars.anims.revealTiles()}))}if("newGame"===n)return void vars.game.new();if(n.startsWith("redFlag_")){if(vars.DEBUG&&console.log(`Red Flag (${n}) clicked on`),2===e.button){t.destroy();let e=vars.game,i=e.flags.findIndex(e=>e.name===n);return e.flags.splice(i,1),void vars.UI.updateVisibleCount()}return}if(n.startsWith("options_")){if(vars.DEBUG&&console.log(`Options button clicked`),n=n.replace("options_",""),n.startsWith("bS_")){let e=n.split("_")[1].split("x"),t=0|e[0],i=0|e[1];return vars.boardSetSize(t,i),void(vars.phaserObjects.options_selectedTick.y=vars.phaserObjects.options_newSelectionTick.y)}if(n.startsWith("bD_"))return n=n.split("_")[1].toLowerCase(),vars.difficulty.current=n,vars.phaserObjects.options_selectedDTick.y=vars.phaserObjects.options_newSelectionDTick.y,!0;switch(n){case"upWidth":return vars.DEBUG&&console.log("  > Increasing the width var"),void vars.boardSizeWidthIncrease();break;case"downWidth":return vars.DEBUG&&console.log("  > Decreasing the width var"),void vars.boardSizeWidthIncrease(!1);break;case"upHeight":return vars.DEBUG&&console.log("  > Increasing the height var"),void vars.boardSizeHeightIncrease();break;case"downHeight":return vars.DEBUG&&console.log("  > Decreasing the height var"),void vars.boardSizeHeightIncrease(!1);break;case"startGame":vars.DEBUG&&console.log(`Starting game`),vars.game.ready?null:vars.game.ready=!0,vars.game.new();break;default:vars.DEBUG&&console.log(`  > Unknown option button with name ${n}`);}return}if("optionsButton"==n)return void vars.UI.hideOptions(!1);n&&console.warn(`Unknown button ${n}!`)}),scene.input.on("gameobjectover",function(e,t){if(vars.containers.options.alpha)return"playerstats"===t.name?void vars.phaserObjects.iDI.setVisible(!0):void vars.input.overOption(t);if(t.name.startsWith("boardPosition_"))return void vars.phaserObjects.highlight.setPosition(t.x,t.y)}),scene.input.on("gameobjectout",function(e,t){if(vars.containers.options.alpha)return"playerstats"===t.name?void vars.phaserObjects.iDI.setVisible(!1):(vars.phaserObjects.options_newSelectionTick.y=vars.phaserObjects.options_selectedTick.y,void(vars.phaserObjects.options_newSelectionDTick.y=vars.phaserObjects.options_selectedDTick.y))}),scene.input.on("wheel",function(e,t,n,i){return!1})},initCombos:()=>{let e=scene.input.keyboard;e.createCombo("reset",{resetOnMatch:!0}),e.on("keycombomatch",function(e){let t="";e.keyCodes.forEach(e=>{t+=String.fromCharCode(e)});"RESET"===t?(vars.localStorage.resetAll(),vars.UI.updateStats()):void 0})},overOption:e=>{let t=e.name;return!!t.startsWith("options_")&&((t=t.replace("options_",""),t.startsWith("bS_"))?void(vars.phaserObjects.options_newSelectionTick.y=e.y+30):t.startsWith("bD_")?void(vars.phaserObjects.options_newSelectionDTick.y=e.y+30):void 0)}},particles:{init:()=>{vars.DEBUG&&console.log(`%cFN: particles > init`,`${consts.console.defaults} ${consts.console.colours.functionCall}`),scene.particles={}},new:()=>{}},phaser:{convertHSLToTint:(e=null)=>(checkType(e,"number")||console.error(`Invalid hue ${e}`),Phaser.Display.Color.HSLToColor(e/360,1,.5).color)},UI:{init:function(){vars.DEBUG&&console.log(`%cFN: ui > init`,`${consts.console.defaults} ${consts.console.colours.functionCall}`);let e=vars.UI;e.initGameUI(),e.initOptions(),e.initGeneratingMap()},initGameUI:()=>{let e=consts.canvas,t=vars.containers.gameUI,n=vars.fonts.default,i=vars.phaserObjects.unlockedText=scene.add.text(e.cX,e.height-10,`Mines: 0. Flags: 0. Cleared 0 of 0 (0%)`,n).setOrigin(.5,1);t.add(i);let a=vars.phaserObjects.gameOverBG=scene.add.image(e.cX,e.cY,"whitepixel").setScale(e.width*(1/.7),e.height*(1/.7)).setTint(0).setAlpha(0);t.add(a);let o=vars.phaserObjects.winPopUp=scene.add.image(e.cX,.4*e.height,"ui","winner").setAlpha(0);o.hMin=30,o.hMax=150,o.h1=30,o.h1Reverse=!1,o.h2=90,o.h2Reverse=!1,t.add(o),o.tween=scene.tweens.add({targets:o,duration:3e3,scale:1.2,yoyo:!0,repeat:-1,ease:"Bounce",onUpdate:(e,t)=>{if(!t.alpha)return!1;let n=.25,i=t;i.h1Reverse?i.h1-n>=i.hMin?i.h1-=n:i.h1Reverse=!i.h1Reverse:i.h1+n<=i.hMax?i.h1+=n:i.h1Reverse=!i.h1Reverse;i.h2Reverse?i.h2-n>=i.hMin?i.h2-=n:i.h2Reverse=!i.h2Reverse:i.h2+n<=i.hMax?i.h2+=n:i.h2Reverse=!i.h2Reverse;let a=vars.phaser.convertHSLToTint(i.h1),o=vars.phaser.convertHSLToTint(i.h2);t.setTint(a,o,o,a)}});let d=vars.phaserObjects.losePopUp=scene.add.image(e.cX,.4*e.height,"ui","loser").setAlpha(0);d.hMin=30,d.hMax=150,d.h1=30,d.h1Reverse=!1,d.h2=90,d.h2Reverse=!1,t.add(d),d.tween=scene.tweens.add({targets:d,duration:3e3,scale:1.2,yoyo:!0,repeat:-1,ease:"Bounce",onUpdate:(e,t)=>{if(!t.alpha)return!1;let n=.25,i=t;i.h1Reverse?i.h1-n>=i.hMin?i.h1-=n:i.h1Reverse=!i.h1Reverse:i.h1+n<=i.hMax?i.h1+=n:i.h1Reverse=!i.h1Reverse;i.h2Reverse?i.h2-n>=i.hMin?i.h2-=n:i.h2Reverse=!i.h2Reverse:i.h2+n<=i.hMax?i.h2+=n:i.h2Reverse=!i.h2Reverse;let a=vars.phaser.convertHSLToTint(i.h1),o=vars.phaser.convertHSLToTint(i.h2);t.setTint(a,o,o,a)}});let s=vars.tileType;switch(s){case"water":var r="Water";break;case"grass":var r="Grass";}let l=vars.phaserObjects.newGameButton=scene.add.image(e.cX,.75*e.height,"ui",`newGame${r}`).setName("newGame").setAlpha(0).setInteractive(),c=vars.phaserObjects.optionsButton=scene.add.image(e.width-10,10,"options",`optionsIcon`).setName("optionsButton").setOrigin(1,0).setInteractive();t.add([l,c])},initGeneratingMap:()=>{let e=consts.canvas,t=scene.containers.generatingMap,n=scene.add.image(e.cX,e.cY,"whitepixel").setScale(e.width,e.height).setTint(0).setInteractive(),i=16744448,a=scene.add.bitmapText(e.cX,.2*e.height,"defaultFont","GENERATING MINEFIELD\n\nPLEASE WAIT",96,1).setOrigin(.5).setTint(i).setLetterSpacing(10),o=scene.add.bitmapText(e.cX,.75*e.height,"defaultFont",`Don't Panic if the game looks like it has crashed. It hasn't :)\n\nGenerating Large Maps can take between\n5 and 10s depending on the speed of your CPU`,32,1).setOrigin(.5).setTint(i).setLetterSpacing(10);t.add([n,a,o]);let d=vars.phaserObjects.spinner=scene.add.image(e.cX,.5*e.height,"ui","spinner");d.tweens={},d.tweens.rotation=scene.tweens.add({targets:d,angle:360,diration:1e3,repeat:-1}),t.add(d),vars.containers.showGenMap(!1)},iniLoadingScreen:()=>{let e=consts.canvas;vars.containers?null:vars.containers={};let t=vars.containers.loadingScreen=scene.add.container().setName("loadingScreen").setDepth(999),n=scene.add.image(0,0,"loadingScreen","bgTile").setScale(e.width,1).setOrigin(0);t.add(n);let i=.1*e.width,o=i-100,d=350,s=150,r=50,l=!0;["m","i","n","e"].forEach(e=>{let n=(0|l)*s,c=scene.add.image(o,d-n,"loadingScreen",`${e}Mine`).setOrigin(0);c.tween=scene.add.tween({targets:c,delay:r,duration:1e3,y:c.y-80,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"}),t.add(c),o+=i,l=!l,r+=50}),o=.3*e.width-100,r=50,d+=400,["s","w","e","e","p","e","r"].forEach(e=>{let n=(0|l)*s,c=scene.add.image(o,d+n,"loadingScreen",`${e}Mine`).setOrigin(0);c.tween=scene.add.tween({targets:c,delay:r,duration:1e3,y:c.y-80,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"}),t.add(c),o+=i,l=!l,r+=50})},initOptions:()=>{let e=consts.canvas,t=vars.containers.options,n=scene.add.image(e.cX,e.cY,"whitepixel").setScale(e.width*(1/.7),e.height*(1/.7)).setTint(5150127,5150127,64,64).setInteractive();t.add(n);let i=1>vars.version?`${vars.version}beta`:vars.version,a=3e3,o=scene.add.bitmapText(10,e.height-10,"defaultFontSmall",`${config.title}\nVersion ${i}\nBuilt in javascript by offer0 - AUG 2022\nUses the PHASER game engine`,24).setOrigin(0,1).setTint(16744448).setDepth(consts.depths.debug).setLetterSpacing(10);o.tween=scene.tweens.add({targets:o,alpha:.25,delay:a,duration:a,hold:10*a,yoyo:!0,repeat:-1});let d=0,s=480,r=160;["m","i","n","e","s","w","e","e","p","e","r"].forEach(e=>{let n=scene.add.image(s,r,"loadingScreen",`${e}Mine`).setOrigin(0).setScale(.5);n.tween=scene.add.tween({targets:n,useFrames:!0,delay:d,duration:120,y:n.y-80,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"}),t.add(n),s+=150,d+=10});s=e.cX-370;let l=scene.add.image(s,400,"options","optionsSection_upper").setOrigin(.5,0),c=scene.add.image(s,l.y+l.height,"options","optionsSection_mid").setOrigin(.5,0).setScale(1,600),p=scene.add.image(s,c.y+c.displayHeight,"options","optionsSection_lower").setOrigin(.5,0);t.add([l,c,p]);let h=300,u=780,g=scene.add.image(s+u,400,"options","optionsSection_upper").setOrigin(.5,0),m=scene.add.image(s+u,g.y+g.height,"options","optionsSection_mid").setOrigin(.5,0).setScale(1,h),f=scene.add.image(s+u,m.y+m.displayHeight,"options","optionsSection_lower").setOrigin(.5,0);t.add([g,m,f]),h=100,u=780;let w=scene.add.image(s+u,900,"options","optionsSection_upper").setOrigin(.5,0),b=scene.add.image(s+u,w.y+w.height,"options","optionsSection_mid").setOrigin(.5,0).setScale(1,h),S=scene.add.image(s+u,b.y+b.displayHeight,"options","optionsSection_lower").setOrigin(.5,0);t.add([w,b,S]),s-=150;r=850,r+=60;let v=scene.add.image(s-10,r,"options","upButton").setName("options_upWidth").setInteractive(),O=scene.add.image(s+160,r,"options","upButton").setName("options_upHeight").setInteractive();r+=130;let D=scene.add.image(s-10,r,"options","downButton").setName("options_downWidth").setInteractive(),T=scene.add.image(s+160,r,"options","downButton").setName("options_downHeight").setInteractive();t.add([v,O,D,T]);let I=11585759,C=vars.boardSizes,U=0;r=460;let E=0,B=45,F=6,G=48,k=scene.add.bitmapText(e.cX-370,r,"defaultFontSmall","BOARD SIZE",B).setOrigin(.5).setTint(11585759).setLetterSpacing(F).setInteractive(),A=scene.add.bitmapText(e.cX-370+u,r,"defaultFontSmall","DIFFICULTY",B).setOrigin(.5).setTint(11585759).setLetterSpacing(F).setInteractive();t.add([k,A]),r+=G;let z=320;for(let e in C){let n=C[e],i=`${n.width} x ${n.height}`,a=r+72*E,o=`options_bS_${i.replaceAll(" ","")}`,d=vars.phaserObjects[o]=scene.add.bitmapText(s-60,a,"defaultFontSmall",i,B).setName(o).setOrigin(U).setTint(I).setLetterSpacing(F).setInteractive();if(!E){d.selected=!0;let e=vars.phaserObjects.options_newSelectionTick=scene.add.image(s+z,a+30,"options","selected").setTint(14540253).setAlpha(.5),n=vars.phaserObjects.options_selectedTick=scene.add.image(s+z,a+30,"options","selected").setTint(I);t.add([e,n])}d.input.hitArea.width=400,t.add(d),E++}let M=vars.localStorage,j=[M.userDefinedWidth,M.userDefinedHeight];r=940;let _=vars.phaserObjects.userWidthText=scene.add.bitmapText(s-10,r,"defaultFontSmall",j[0],B).setOrigin(.5,0).setTint(11585759).setLetterSpacing(F).setInteractive(),P=scene.add.bitmapText(s+60,r,"defaultFontSmall","x",B).setOrigin(U).setTint(11585759),R=vars.phaserObjects.userHeightText=scene.add.bitmapText(s+160,r,"defaultFontSmall",j[1],B).setOrigin(.5,0).setTint(11585759).setLetterSpacing(F).setInteractive();t.add([_,P,R]);let W=vars.difficulty.minePercent;for(let e in E=0,r=460+G,W){let n=e.toUpperCase(),i=r+72*E,a=`options_bD_${n}`,o=vars.phaserObjects[a]=scene.add.bitmapText(s-60+u,i,"defaultFontSmall",n,B-10).setName(a).setOrigin(U).setTint(I).setLetterSpacing(F).setInteractive();if(!E){o.selected=!0;let e=vars.phaserObjects.options_newSelectionDTick=scene.add.image(s+z+u,i+30,"options","selected").setTint(14540253).setAlpha(.5),n=vars.phaserObjects.options_selectedDTick=scene.add.image(s+z+u,i+30,"options","selected").setTint(I);t.add([e,n])}o.input.hitArea.width=400,t.add(o),E++}let N=vars.phaserObjects.startButton=scene.add.bitmapText(s+u-10,w.y+w.height+20,"defaultFontSmall","BEGIN !",B+10).setName("options_startGame").setOrigin(U).setTint(11585759).setLetterSpacing(F).setInteractive();t.add(N);let H=vars.localStorage.uData,L=H.w,X=H.l,V=H.i,Z=vars.phaserObjects.stats=scene.add.bitmapText(.654*e.width,.9*e.height,"defaultFontSmall",`${L} WINS.\n${X} LOSSES.\n${V} INSTA DEATHS*`,B).setOrigin(.5).setTint(11585759).setName("playerstats").setInteractive();vars.phaserObjects.stats.hasOver=!0;let Y=vars.phaserObjects.iDI=scene.add.bitmapText(e.width-10,e.height-10,"defaultFontSmall",`* losses where you had less than 3 total moves`,B/2).setOrigin(1).setTint(11585759).setVisible(!1);t.add([Z,Y])},blowUpAllMinesByColumn:e=>{let t=vars.game,n=t.sortMinesIntoColumns(),i=n[e];if(i&&i.forEach(e=>{e.play("explosion")}),n){let t=vars.boardSize.width,i=e-1,a=1;for(;0<=i;){let e=n[i];scene.tweens.addCounter({from:0,to:1,useFrames:!0,delay:5*a,duration:10,onComplete:()=>{e&&e.forEach(e=>{e.play("explosion")})}}),i--,a++}let o=e+1,d=1;for(;o<t;){let e=n[o];scene.tweens.addCounter({from:0,to:1,useFrames:!0,delay:5*d,duration:10,onComplete:()=>{e&&e.forEach(e=>{e.play("explosion")})}}),o++,d++}return d>a?5*d:5*a}return!1},gameOverFadeIn:(e=!0)=>{let t=e?1:0,n=t?2e3:500;vars.DEBUG&&console.log(`Fading ${t?"in":"out"} game over screen`);let i=t?.7:0;scene.tweens.add({targets:vars.phaserObjects.gameOverBG,alpha:i,duration:1e3}),t||scene.tweens.add({targets:vars.phaserObjects.newGameButton,alpha:t,duration:500});scene.tweens.add({targets:vars.phaserObjects.losePopUp,alpha:t,duration:n,onComplete:()=>{t&&scene.tweens.add({targets:vars.phaserObjects.newGameButton,alpha:t,duration:500})}})},gameWinFadeIn:(e=!0)=>{let t=e?1:0,n=t?2e3:500;vars.DEBUG&&console.log(`Fading ${t?"in":"out"} game win screen`);let i=t?.7:0;scene.tweens.add({targets:vars.phaserObjects.gameOverBG,alpha:i,duration:500}),scene.tweens.add({targets:vars.phaserObjects.winPopUp,alpha:t,duration:n,onComplete:()=>{scene.tweens.add({targets:vars.phaserObjects.newGameButton,alpha:t,duration:500})}})},generateFleet:()=>{let e=consts.canvas,t=vars.game,n=consts.depths.gameUI,i=vars.boardSize,a=vars.containers.clicked.y,o=vars.boardTileSizes.x;for(let d=0;d<i.height;d++){let i=`battleship_${getRandom(0,2)}`,s=100*getRandom(2,6),r=scene.add.image(-s,d*o+a+16,"mapPieces",i).setOrigin(0).setDepth(n);t.boatCount++,scene.tweens.add({targets:r,useFrames:!0,x:e.width+200+s/2,delay:getRandom(1,30),duration:800,onComplete:(e,n)=>{n[0].destroy(),t.boatCount--,t.boatCount||vars.UI.gameWinFadeIn()}})}},generateFlyOver:()=>{let e=consts.canvas,t=vars.containers.clicked,n=t.height,i=t.x,a=vars.boardTileSizes.x,o=2*a,d=o/256,s=vars.boardSize.width,r=t.y;for(let t=0;t<(0|n/o+.5);t++){let n=100*getRandom(0,4),l=scene.add.image(-200-n,r,"mapPieces","b17_256").setName(`plane_${t}`).setOrigin(0).setScale(d).setDepth(consts.depths.gameUI);l.currentlyOver=-1,scene.tweens.add({targets:l,x:e.width+128+n/2,delay:100*getRandom(0,10),duration:4e3,onComplete:(e,t)=>{t[0].tween.remove(),t[0].destroy()},onUpdate:(e,t)=>{if(t.x+2*a<i)return!1;let n=2*(0|t.name.split("_")[1]),o=0|(t.x-i)/a;if(o>=s)return!1;if(t.currentlyOver!==o){t.currentlyOver=o;let e=!1;vars.game.getMineByPosition(t.currentlyOver,n)&&(vars.DEBUG&&console.log(`Mine found at row ${n}, col ${t.currentlyOver}`),vars.game.getMineByPosition(t.currentlyOver,n).play("explosion"),e=!0),vars.game.getMineByPosition(t.currentlyOver,n+1)&&(vars.DEBUG&&console.log(`Mine found at row ${n}, col ${t.currentlyOver}`),vars.game.getMineByPosition(t.currentlyOver,n+1).play("explosion"),e=!0),e&&vars.audio.playExplosion()}}}),l.tween=scene.tweens.add({targets:l,scale:.6*d,duration:1e3,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"}),r+=o}vars.audio.playAircraftDrone()},generateNewBoard:()=>{let e=consts.canvas,t=e.width,n=e.height,i=vars.boardTileSizes,a=vars.boardSize,o=[i.x*a.width,i.y*a.height],d=(t-o[0])/2,s=(n-o[1])/2,r=vars.containers.unclicked;r.width=o[0],r.height=o[1],r.setPosition(d,s);let l=vars.containers.clicked;l.setPosition(d,s),l.width=r.width,l.height=r.height;let c=vars.containers.flags;c.setPosition(d,s),c.width=r.width,c.height=r.height},generateRevealedTiles:()=>{let e=new Date,t=vars.game,n=vars.containers,i=vars.boardSize,a=i.width,o=i.height,d=t.grid,s=t.mines,r=vars.fonts.number,l=n.clicked,c=n.unclicked,p=0,h=vars.boardTileSizes.x,u=vars.groups;for(let t,n=0;n<a;n++){t=u[`colGroup_${n}`];for(let e=0;e<o;e++){let i=d[n][e],a=i.neighbourCount,o=i.mine,u=i.w,g=i.x,m=i.y;if(p?null:p=u/2,`${u-4}px`===r.fontSize?null:r.fontSize=`${u-4}px`,o){let i=scene.add.sprite(g+p,m+p,"mapPieces",`mine${u}`).setName(`mine_${n}_${e}`).setScale(.9);s.push(i),l.add(i),t.add(i);let a=scene.add.image(g,m,"mapPieces",`water${h}`).setName(`boardPosition_${n}_${e}`).setOrigin(0).setInteractive();c.add(a);continue}let f=a?a:"";if(a){let e=scene.add.image(g,m,"mapPieces",`waterUL${u}`).setOrigin(0);l.add(e),t.add(e)}else{let e=scene.add.image(g,m,"mapPieces",`water${u}`).setAlpha(.2).setOrigin(0);l.add(e),t.add(e)}let w=scene.add.text(g+p,m+p,f,r).setOrigin(.5);l.add(w),t.add(w);let b=scene.add.image(g,m,"mapPieces",`water${h}`).setName(`boardPosition_${n}_${e}`).setOrigin(0).setInteractive();c.add(b)}vars.DEBUG&&console.log("Column Time: "+~~((new Date-e)/10)/100)}vars.phaserObjects.highlight=scene.add.image(0,0,"mapPieces",`highlightWater${h}`).setOrigin(0),c.add(vars.phaserObjects.highlight);let g=~~((new Date-e)/10)/100;vars.DEBUG&&console.log(`Generate Revealed Tiles took ${g}s`)},hideOptions:(e=!0)=>{let t=e?0:1;scene.tweens.add({targets:vars.containers.options,alpha:t,duration:500})},updateOptionsBoardSizeHeight:()=>{vars.phaserObjects.userHeightText.setText(vars.boardSize.height)},updateOptionsBoardSizeWidth:()=>{vars.phaserObjects.userWidthText.setText(vars.boardSize.width)},updateStats:()=>{let e=vars.localStorage.uData,t=e.w,n=e.l,i=e.i;vars.phaserObjects.stats.setText(`${t} WINS.\n${n} LOSSES.\n${i} INSTA DEATHS*`)},updateVisibleCount:(e=!1)=>{let t=vars.game.visibleCount,n=t.unlocked,i=t.total,a=vars.game.totalMines;vars.phaserObjects.unlockedText.setText(`Mines: ${vars.game.mines.length}. Flags: ${vars.game.flags.length}. Cleared ${n} of ${i-a} (${~~(100*(n/(i-a)))}%)`),e||n!==i-a?null:vars.game.win()}}};const consts={canvas:{width:2560,height:1440,cX:1280,cY:720},console:{colours:{functionCall:"#4DA6FF",important:"#FFFF00",bad:"#FF0000",warn:"#FF0000",good:"#63e763"},defaults:"font-weight: bold; font-size: 12px; font: 'consolas'; color:"},depths:{clicked:5,unclicked:10,flags:15,gameUI:20,options:50,generatingMap:70,loadingScreen:100,debug:666}};let Cell=class{constructor(e,t,n){this.col=e,this.row=t,this.w=n,this.x=this.col*this.w,this.y=this.row*this.w,this.init()}init(){this.neighbourCount=0,this.mine=!1,this.revealed=!1}countMines(){if(this.mine)return void(this.neighbourCount=-1);let e=vars.game.grid,t=0,n=vars.boardSize.width,i=vars.boardSize.height;for(let o,d=-1;1>=d;d++)if(o=this.col+d,!(0>o||o>=n))for(let n,d=-1;1>=d;d++)if(n=this.row+d,!(0>n||n>=i)){var a=e[o][n];a.mine?t++:null}this.neighbourCount=t}floodFill(){let e=vars.boardSize.width,t=vars.boardSize.height,n=vars.game.grid;for(let a,o=-1;1>=o;o++)if(a=this.col+o,!(0>a||a>=e))for(let e,o=-1;1>=o;o++)if(e=this.row+o,!(0>e||e>=t)){var i=n[a][e];i.revealed?null:i.reveal()}}reveal(){this.revealed=!0;let e=vars.containers.unclicked,t=vars.reveal,n=e.getByName(`boardPosition_${this.col}_${this.row}`);return 1===n.alpha&&(t.count++,t.revealing.push(n)),this.mine?"dead":void(vars.game.visibleCount.update(),this.neighbourCount?null:this.floodFill())}};"use strict",vars.DEBUG=!!(window.location.href.includes("offero04")&&window.location.href.includes("/GAMES/")),vars.DEBUG&&console.log("Initialising...");var scene,config={title:"MineSweeperJS",version:vars.version,url:window.location.href,banner:!1,type:Phaser.WEBGL,backgroundColor:"#003474",disableContextMenu:!0,height:consts.canvas.height,width:consts.canvas.width,loader:{crossOrigin:"anonymous"},scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH,width:consts.canvas.width,height:consts.canvas.height},scene:{preload:preload,create:create,pack:{files:[{type:"atlas",key:"loadingScreen"}]}}},game=new Phaser.Game(config);function preload(){scene=this,vars.init("PRELOAD")}function create(){vars.init("CREATE"),vars.init("STARTAPP")}